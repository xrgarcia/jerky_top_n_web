<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jerky Top N Web - Premium Jerky Rankings</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="style.css?v=20251019-sage">
    <link rel="stylesheet" href="css/home-dashboard.css">
    <link rel="stylesheet" href="css/hero-dashboard.css">
    <link rel="stylesheet" href="css/progress-widget.css">
    <link rel="stylesheet" href="css/page-header.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/admin-dashboard.css">
    <link rel="stylesheet" href="css/coinbook.css">
    <link rel="stylesheet" href="css/achievement-detail.css">
</head>
<body>
    <!-- Green Announcement Banner -->
    <div class="announcement-banner">
        <span class="announcement-icon">üèÜ</span>
        <span class="announcement-text">TAKE OUR QUIZ, GET FREE JERKY</span>
        <button class="announcement-btn">TAKE THE QUIZ</button>
    </div>

    <!-- Dark Navigation Bar -->
    <nav class="main-nav">
        <div class="nav-container">
            <div class="logo">
                <img src="https://www.jerky.com/cdn/shop/files/jerky_logo_aeed54c0-3f7f-462d-93c3-785b3c97af9d_150x.png?v=1678208718&t=20250928" alt="Jerky.com Logo" class="logo-img" loading="eager">
            </div>
            
            <div class="nav-links">
                <a href="#home" class="nav-link" data-page="home">HOME</a>
                <a href="#products" class="nav-link" data-page="products">PRODUCTS</a>
                <a href="#coinbook" class="nav-link" data-page="coinbook">üèÜ COIN BOOK</a>
                <div class="nav-item-with-dropdown">
                    <a href="#community" class="nav-link nav-dropdown-trigger" data-page="community">
                        <span>COMMUNITY</span>
                        <span class="nav-dropdown-arrow">‚ñº</span>
                    </a>
                    <div class="nav-dropdown-menu">
                        <a href="#community">COMMUNITY</a>
                        <a href="#leaderboard">LEADERBOARD</a>
                    </div>
                </div>
                <a href="#rank" class="nav-link" data-page="rank">RANK</a>
                <a href="#tools" class="nav-link" data-page="tools" id="toolsNavLink" style="display: none;">TOOLS</a>
            </div>            
            <div class="nav-actions">
                <div class="search-container">
                    <input type="text" placeholder="Search for people or products" class="search-input" id="globalSearchInput" autocomplete="off">
                    <button class="search-btn" aria-label="Search">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                    </button>
                    <div class="search-dropdown" id="globalSearchDropdown"></div>
                </div>
                <div class="user-actions">
                    <button class="login-btn" id="loginBtn" style="display: inline;" aria-label="Log in to your account">LOG IN</button>
                    <div class="user-profile" id="userProfile" style="display: none;">
                        <div class="user-avatar" id="userAvatar" title="View Profile" role="button" tabindex="0" aria-label="View your profile"></div>
                        <button class="logout-btn" id="logoutBtn" aria-label="Log out of your account">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero" id="heroSection">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <!-- Main Title Banner -->
            <div class="hero-banner">
                <h1 class="hero-title">Rank Your Favorite Jerky</h1>
                <p class="hero-subtitle">Join the community ‚Ä¢ Discover new flavors ‚Ä¢ Earn achievements</p>
            </div>

            <!-- Gamification Dashboard -->
            <div class="hero-dashboard" id="heroDashboard">
                <!-- Live Stats Counters -->
                <div class="hero-stats">
                    <div class="hero-stat-card">
                        <div class="stat-icon">üî•</div>
                        <div class="stat-value" id="heroActiveRankers">...</div>
                        <div class="stat-label">Active Rankers Today</div>
                    </div>
                    <div class="hero-stat-card">
                        <div class="stat-icon">‚≠ê</div>
                        <div class="stat-value" id="heroAchievementsWeek">...</div>
                        <div class="stat-label">Achievements This Week</div>
                    </div>
                    <div class="hero-stat-card">
                        <div class="stat-icon">üèÜ</div>
                        <div class="stat-value" id="heroTotalRankings">...</div>
                        <div class="stat-label">Total Rankings</div>
                    </div>
                </div>

                <!-- User Progress Area (shown when logged in) -->
                <div class="hero-user-progress" id="heroUserProgress" style="display: none;">
                    <div class="progress-content">
                        <div class="progress-item">
                            <span class="progress-icon">üî•</span>
                            <span class="progress-text" id="heroUserStreak">Your Streak: Loading...</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-icon">üìä</span>
                            <span class="progress-text" id="heroUserRank">Rank: Loading...</span>
                        </div>
                        <div class="progress-item">
                            <span class="progress-icon">üéØ</span>
                            <span class="progress-text" id="heroUserNext">Next: Loading...</span>
                        </div>
                    </div>
                </div>

                <!-- Social Proof Slider -->
                <div class="hero-achievements-slider">
                    <div class="slider-container" id="heroAchievementsSlider">
                        <div class="slider-item">Loading recent achievements...</div>
                    </div>
                </div>

                <!-- Dual CTAs -->
                <div class="hero-cta-buttons">
                    <button class="hero-cta-btn primary" id="heroStartRankingBtn">
                        <span class="cta-text">Start Ranking Now</span>
                        <span class="cta-icon">‚Üí</span>
                    </button>
                    <button class="hero-cta-btn secondary" id="heroLeaderboardBtn">
                        <span class="cta-text">View Leaderboard</span>
                        <span class="cta-icon">üèÜ</span>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <main class="main-content" id="mainContent">
        <!-- Home Page Content -->
        <div class="page-content" id="homePage" style="display: none;">
            <section class="welcome-section">
                <h2>Find the Perfect Jerky For You!</h2>
                <p>Discover What the Community Loves</p>
                
                <!-- Community Stats Overview -->
                <div id="communityStatsOverview" class="community-stats-overview"></div>
                
                <!-- Home Dashboard Grid -->
                <div class="home-dashboard">
                    <div class="dashboard-section" id="topProductsSection">
                        <div class="widget-header">
                            <div class="widget-title-group">
                                <h3>‚≠ê Community Favorites</h3>
                                <p class="section-subtitle">The crowd has spoken! See what's winning hearts.</p>
                            </div>
                            <a href="#rank" class="widget-action-btn" aria-label="Rank your favorites">Rank This Too!</a>
                        </div>
                        <div id="topProductsList" class="dashboard-list"></div>
                    </div>
                    
                    <div class="dashboard-section" id="topRankersSection">
                        <div class="widget-header">
                            <div class="widget-title-group">
                                <h3>üèÜ Top Rankers</h3>
                                <p class="section-subtitle">Think you can top them? Start ranking to compete!</p>
                            </div>
                            <a href="#rank" class="widget-action-btn" aria-label="Join the competition">Join the Race</a>
                        </div>
                        <div id="topRankersList" class="dashboard-list"></div>
                    </div>
                    
                    <div class="dashboard-section" id="recentlyRankedSection">
                        <div class="widget-header">
                            <div class="widget-title-group">
                                <h3>üÜï Recently Ranked</h3>
                                <p class="section-subtitle">Fresh off the grill! See what's being ranked right now.</p>
                            </div>
                            <a href="#products" class="widget-action-btn secondary" aria-label="View all products">Explore All</a>
                        </div>
                        <div id="recentlyRankedList" class="dashboard-list"></div>
                    </div>
                    
                    <div class="dashboard-section" id="trendingSection">
                        <div class="widget-header">
                            <div class="widget-title-group">
                                <h3>üî• Trending This Week</h3>
                                <p class="section-subtitle">Don't miss out on what's hot in the community!</p>
                            </div>
                            <a href="#rank" class="widget-action-btn secondary" aria-label="Jump on trending products">Jump In!</a>
                        </div>
                        <div id="trendingList" class="dashboard-list"></div>
                    </div>
                    
                    <div class="dashboard-section" id="debatedSection">
                        <div class="widget-header">
                            <div class="widget-title-group">
                                <h3>‚öîÔ∏è Most Debated</h3>
                                <p class="section-subtitle">The community can't agree - you decide!</p>
                            </div>
                            <a href="#rank" class="widget-action-btn" aria-label="Settle the debate">Settle It!</a>
                        </div>
                        <div id="debatedList" class="dashboard-list"></div>
                    </div>
                    
                    <div class="dashboard-section" id="achievementsSection">
                        <div class="widget-header">
                            <div class="widget-title-group">
                                <h3>üèÖ Recent Achievements</h3>
                                <p class="section-subtitle">Unlock your next badge! Start ranking to earn.</p>
                            </div>
                            <a href="#rank" class="widget-action-btn" aria-label="Earn achievements">Earn Badges</a>
                        </div>
                        <div id="recentAchievementsList" class="dashboard-list"></div>
                    </div>

                    <!-- Call to Action Section -->
                    <div class="home-cta-section">
                        <div class="home-cta-content">
                            <h2 class="home-cta-title">Join the Flavor Revolution üî•</h2>
                            <div class="home-cta-body">
                                <img src="https://www.jerky.com/cdn/shop/files/browse_best_sellers.png?v=1704231147&width=240" alt="Customer holding jerky to heart" class="home-cta-image">
                                <p class="home-cta-text">We're more than just jerky ‚Äì we're a community of meat snack enthusiasts on a mission to find the perfect chew. Share your rankings, discover new flavors, and compete for the top spot on our leaderboard. Your taste buds deserve the best!</p>
                            </div>
                            <a href="#rank" class="home-cta-button">
                                <span>Start Ranking Now</span>
                                <span class="cta-arrow">‚Üí</span>
                            </a>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        
        <!-- Rank Product Page Content -->
        <div class="page-content" id="rankPage" style="display: none;">
            <div class="page-header-minimal">
                <div class="page-header-content">
                    <div class="page-header-text">
                        <div class="page-header-breadcrumbs">
                            <a href="#home">Home</a>
                            <span>‚Ä∫</span>
                            <span>Rank</span>
                        </div>
                        <h1 class="page-header-title">
                            <span class="page-header-icon">üèÜ</span>
                            <span>Rank Your Favorites</span>
                        </h1>
                        <p class="page-header-subtitle">Build your ultimate jerky lineup and show the community what you're snacking on ü•©</p>
                    </div>
                    <div class="page-header-action">
                        <a href="#products" class="page-action-btn">
                            <span class="icon">üîç</span>
                            <span>Browse All</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Rank Page Container -->
            <div class="rank-page-container">
                <!-- Split Screen Layout -->
                <div class="ranking-container">
                <!-- Left Side: Ranking Slots -->
                <div class="ranking-panel" id="rankingPanel">
                    <div class="panel-header">
                        <h3>üèÜ Your Rankings</h3>
                        <div class="center-status">
                            <div id="statusIndicator" class="status-indicator"></div>
                        </div>
                        <button id="toggleRankingsBtn" class="toggle-btn">‚ñº Collapse</button>
                        <button id="clearRankingBtn" class="clear-btn">Clear All</button>
                    </div>
                    <div class="ranking-slots" id="rankingSlots">
                        <!-- Ranking slots will be generated dynamically -->
                    </div>
                </div>
                
                <!-- Right Side: Product Search -->
                <div class="search-panel">
                    <div class="panel-header">
                        <h3>üîç Search Products</h3>
                        <div class="search-controls">
                            <input type="text" id="productSearch" placeholder="Search jerky products..." class="search-input-field" autocomplete="off">
                            <button id="searchBtn" class="search-btn-field">Search</button>
                        </div>
                    </div>
                    <div class="product-results" id="productResults">
                        <div id="productLoading" class="loading" style="display: none;">Loading products...</div>
                        <div id="productList" class="product-list"></div>
                        <div id="loadMoreBtn" class="load-more" style="display: none;">Load More Products</div>
                    </div>
                </div>
            </div>
            </div>
        </div>
        
        <!-- Products Page Content -->
        <div class="page-content" id="productsPage" style="display: none;">
            <div class="page-header-minimal">
                <div class="page-header-content">
                    <div class="page-header-text">
                        <div class="page-header-breadcrumbs">
                            <a href="#home">Home</a>
                            <span>‚Ä∫</span>
                            <span>Products</span>
                        </div>
                        <h1 class="page-header-title">
                            <span class="page-header-icon">ü•©</span>
                            <span>All Products</span>
                        </h1>
                        <p class="page-header-subtitle">Explore hundreds of jerky varieties ranked by meat lovers like you üî•</p>
                    </div>
                    <div class="page-header-action">
                        <a href="#rank" class="page-action-btn">
                            <span class="icon">üìù</span>
                            <span>Rank Now</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Animal Categories Filter -->
            <div class="animal-filter-wrapper collapsed" id="animalFilterWrapper">
                <button class="animal-filter-toggle-button" id="animalFilterToggle" aria-expanded="false" aria-label="Show animal filters">
                    <div class="animal-filter-title-section">
                        <span class="animal-filter-title">üêÑ Filter by Animal</span>
                    </div>
                    <span class="animal-filter-chevron">‚ñº</span>
                </button>
                
                <div class="animal-filter-content" id="animalFilterContent" aria-hidden="true" hidden>
                    <div class="animal-categories" id="animalCategories">
                        <!-- Categories will be loaded dynamically -->
                    </div>
                </div>
            </div>
            
            <div class="products-controls">
                <input 
                    type="text" 
                    id="productsSearchInput" 
                    placeholder="Search for jerky products..."
                    autocomplete="off"
                    class="products-search-input"
                >
                <select id="productSortField" class="products-sort-field">
                    <option value="name">Sort by: Name</option>
                    <option value="recent">Sort by: Recently Ranked</option>
                    <option value="avgrank">Sort by: Avg Ranking</option>
                    <option value="totalranks">Sort by: Total Rankings</option>
                </select>
                <button type="button" id="productSortOrder" class="products-sort-order" data-order="asc" title="Toggle sort order">
                    <span class="funnel-icon">‚ñº</span>
                </button>
            </div>

            <div id="productsGrid" class="products-grid">
                <div id="productsLoading" class="loading">Loading products...</div>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button id="productsLoadMoreBtn" class="btn-secondary" style="display: none;">Load More Products</button>
            </div>
        </div>

        <!-- Community Page Content -->
        <div class="page-content" id="communityPage" style="display: none;">
            <div class="page-header-minimal">
                <div class="page-header-content">
                    <div class="page-header-text">
                        <div class="page-header-breadcrumbs">
                            <a href="#home">Home</a>
                            <span>‚Ä∫</span>
                            <span>Community</span>
                        </div>
                        <h1 class="page-header-title">
                            <span class="page-header-icon">üë•</span>
                            <span>Community</span>
                        </h1>
                        <p class="page-header-subtitle">Connect with fellow meat snack enthusiasts and discover what they're ranking ü§ù</p>
                    </div>
                    <div class="page-header-action">
                        <a href="#leaderboard" class="page-action-btn">
                            <span class="icon">üèÜ</span>
                            <span>Leaderboard</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <div id="communityLeaderboard" style="margin-bottom: 30px;"></div>
            
            <div class="search-container" style="max-width: 1200px; margin: 0 auto 30px; padding: 0 20px;">
                <input 
                    type="text" 
                    id="communitySearchInput" 
                    placeholder="Search by name or products they've ranked..."
                    autocomplete="off"
                >
            </div>

            <div id="communityList" class="community-grid" style="min-height: 400px;">
                <div id="communityLoading" class="loading">Loading community members...</div>
            </div>
        </div>

        <!-- Leaderboard Page Content -->
        <div class="page-content" id="leaderboardPage" style="display: none;">
            <div class="page-header-minimal">
                <div class="page-header-content">
                    <div class="page-header-text">
                        <div class="page-header-breadcrumbs">
                            <a href="#home">Home</a>
                            <span>‚Ä∫</span>
                            <a href="#community">Community</a>
                            <span>‚Ä∫</span>
                            <span>Leaderboard</span>
                        </div>
                        <h1 class="page-header-title">
                            <span class="page-header-icon">üèÜ</span>
                            <span>Leaderboard</span>
                        </h1>
                        <p class="page-header-subtitle">See who's dominating the rankings and where you stack up üî•</p>
                    </div>
                    <div class="page-header-action">
                        <a href="#rank" class="page-action-btn">
                            <span class="icon">‚≠ê</span>
                            <span>Start Ranking</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <div id="fullLeaderboard" style="max-width: 1200px; margin: 0 auto; padding: 0 20px;">
                <div class="loading">Loading leaderboard...</div>
            </div>
        </div>

        <!-- Profile Page Content -->
        <div class="page-content" id="profilePage" style="display: none;">
            <div class="page-header-minimal">
                <div class="page-header-content">
                    <div class="page-header-text">
                        <div class="page-header-breadcrumbs">
                            <a href="#home">Home</a>
                            <span>‚Ä∫</span>
                            <span>My Profile</span>
                        </div>
                        <h1 class="page-header-title">
                            <span class="page-header-icon">üë§</span>
                            <span>My Profile</span>
                        </h1>
                        <p class="page-header-subtitle">View your stats, rankings, and achievements</p>
                    </div>
                    <div class="page-header-action">
                        <a href="#rank" class="page-action-btn">
                            <span class="icon">üèÜ</span>
                            <span>Rank More</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="profile-container">
                <div class="profile-header">
                    <div class="profile-avatar" id="profileAvatar"></div>
                    <div class="profile-info">
                        <h2 id="profileName">Loading...</h2>
                        <p id="profileEmail"></p>
                    </div>
                </div>
                
                <div class="profile-stats">
                    <div class="profile-stat-card">
                        <div class="profile-stat-number" id="profileRankedCount">0</div>
                        <div class="profile-stat-label">Products Ranked</div>
                    </div>
                    <div class="profile-stat-card">
                        <div class="profile-stat-number" id="profileListsCount">0</div>
                        <div class="profile-stat-label">Ranking Lists</div>
                    </div>
                </div>

                <div class="user-achievements-section">
                    <h2>üèÜ My Achievements</h2>
                    <div id="profileAchievementsList" class="user-achievements-grid">
                        <div class="loading">Loading achievements...</div>
                    </div>
                </div>

                <div class="profile-actions">
                    <a href="https://www.jerky.com/account" target="_blank" class="profile-update-btn">
                        Update Profile on Jerky.com
                    </a>
                </div>
            </div>
        </div>

        <!-- User Profile Page Content (Community View) -->
        <div class="page-content" id="userProfilePage" style="display: none;">
            <div class="user-profile-page-container">
                <button class="back-button" onclick="goBackToCommunity()">‚Üê Back to Community</button>
                
                <div class="user-profile-header">
                    <div class="user-profile-avatar" id="userProfileAvatar"></div>
                    <div class="user-profile-info">
                        <h1 id="userProfileName">Loading...</h1>
                        <div class="user-profile-stats-inline">
                            <span id="userProfileRankedCount">0</span> products ranked
                        </div>
                    </div>
                </div>
                
                <div class="user-achievements-section">
                    <h2>üèÜ Achievements</h2>
                    <div id="userAchievementsList" class="user-achievements-grid">
                        <div class="loading">Loading achievements...</div>
                    </div>
                </div>
                
                <div class="user-rankings-section">
                    <h2>Product Rankings</h2>
                    <div id="userRankingsList" class="user-rankings-list">
                        <div class="loading">Loading rankings...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Product Detail Page Content -->
        <div class="page-content" id="productDetailPage" style="display: none;">
            <div class="product-detail-container">
                <!-- Breadcrumb Navigation -->
                <div class="product-breadcrumb">
                    <a href="#products" class="breadcrumb-link">Products</a>
                    <span class="breadcrumb-separator">‚Ä∫</span>
                    <span class="breadcrumb-current" id="productBreadcrumb">Loading...</span>
                </div>
                
                <!-- Two-Column Product Layout -->
                <div class="product-two-column">
                    <!-- LEFT: Product Image Gallery -->
                    <div class="product-gallery">
                        <div class="product-main-image">
                            <img id="productDetailPageImage" src="" alt="" class="product-image">
                        </div>
                    </div>
                    
                    <!-- RIGHT: Product Details -->
                    <div class="product-details">
                        <!-- Product Title -->
                        <h1 id="productDetailPageTitle" class="product-title">Loading...</h1>
                        
                        <!-- Community Rating (stars derived from avg rank) -->
                        <div class="product-rating-row">
                            <div class="product-stars" id="productStars">
                                <span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span><span class="star">‚òÜ</span>
                            </div>
                            <span class="product-rating-text" id="productRatingText">No ratings yet</span>
                        </div>
                        
                        <!-- Engaging Tagline -->
                        <div class="product-tagline" id="productTagline">
                            <p>A community favorite, ranked by jerky enthusiasts like you.</p>
                        </div>
                        
                        <!-- Flavor & Category Badges -->
                        <div class="product-badges" id="productBadges">
                            <div id="productDetailPageFlavor" class="product-flavor-badge"></div>
                        </div>
                        
                        <!-- Product Description -->
                        <div class="product-description-section">
                            <div id="productDetailPageDescription" class="product-description-text"></div>
                        </div>
                        
                        <!-- Product Highlights (Bullet Points) -->
                        <div class="product-highlights" id="productHighlights" style="display: none;">
                            <ul id="productHighlightsList"></ul>
                        </div>
                        
                        <!-- Price & Availability -->
                        <div class="product-pricing">
                            <div class="price-display">
                                <span id="productDetailPagePrice" class="current-price">$0.00</span>
                                <span id="productDetailPageComparePrice" class="compare-price"></span>
                                <span id="productSavingsPercent" class="savings-percent"></span>
                            </div>
                            <div class="stock-indicator">
                                <span class="stock-icon">‚úì</span>
                                <span class="stock-text">View on Jerky.com</span>
                            </div>
                        </div>
                        
                        <!-- Primary & Secondary CTAs -->
                        <div class="product-ctas">
                            <a id="buyNowBtn" href="#" target="_blank" rel="noopener noreferrer" class="btn-primary-cta">
                                Buy Now on Jerky.com ‚Üí
                            </a>
                            <button id="rankThisProductBtn" class="btn-secondary-cta">
                                <span class="cta-icon">‚≠ê</span>
                                Rank This Jerky
                            </button>
                        </div>
                        
                        <!-- Community Stats Strip (Social Proof) -->
                        <div class="community-stats-strip">
                            <div class="stats-strip-title">Trusted by Jerky Lovers</div>
                            <div class="stats-badges">
                                <div class="stat-badge">
                                    <span class="badge-icon">üë•</span>
                                    <span class="badge-text">
                                        <strong id="productDetailPageRankers">0</strong> rankers
                                    </span>
                                </div>
                                <div class="stat-badge">
                                    <span class="badge-icon">üìä</span>
                                    <span class="badge-text">
                                        Avg rank: <strong id="productDetailPageAvgRank">N/A</strong>
                                    </span>
                                </div>
                                <div class="stat-badge-range">
                                    <span class="range-label">Community range:</span>
                                    <div class="range-chips">
                                        <span class="chip-best" id="productDetailPageBestChip">#1</span>
                                        <span class="chip-separator">‚Üí</span>
                                        <span class="chip-worst" id="productDetailPageWorstChip">#10</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Full-Width: Product Story Section -->
                <div class="product-story-section" id="productStorySection" style="display: none;">
                    <h2 class="story-title">The Story</h2>
                    <div class="story-content" id="productStoryContent"></div>
                </div>
                
                <!-- Full-Width: Community Testimonials -->
                <div class="product-testimonials-section" id="productTestimonialsSection" style="display: none;">
                    <h2 class="testimonials-title">What Jerky Lovers Are Saying</h2>
                    <div class="testimonials-grid" id="productTestimonialsGrid">
                        <!-- Will be populated dynamically or with defaults -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Login Page Content -->
        <div class="page-content" id="loginPage" style="display: none;">
            <div class="login-page-container">
                <div class="login-content">
                    <div class="login-header">
                        <div class="login-logo">ü•© Jerky.com</div>
                        <h2>Access Your Jerky.com Account</h2>
                        <p class="login-subtitle">Log in with your jerky.com customer email to start ranking products</p>
                    </div>
                    
                    <div class="login-form">
                        <div class="form-group">
                            <label for="loginEmail">Email Address</label>
                            <input 
                                type="email" 
                                id="loginEmail" 
                                class="login-input" 
                                placeholder="your.email@example.com"
                                autocomplete="email"
                            >
                        </div>
                        
                        <button id="submitLoginBtn" class="login-submit-btn">
                            Send Login Link
                        </button>
                        
                        <div id="loginMessage" class="login-message" style="display: none;"></div>
                        
                        <div class="login-note">
                            <p><strong>Note:</strong> You must be a registered jerky.com customer to log in. We'll send you a magic link to access your account.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Coin Book Page Content -->
        <div class="page-content" id="coinbookPage" style="display: none;">
            <div class="page-header-minimal">
                <div class="page-header-content">
                    <div class="page-header-text">
                        <div class="page-header-breadcrumbs">
                            <a href="#home">Home</a>
                            <span>‚Ä∫</span>
                            <span>Coin Book</span>
                        </div>
                        <h1 class="page-header-title">
                            <span class="page-header-icon">üèÜ</span>
                            <span>My Coin Book</span>
                        </h1>
                        <p class="page-header-subtitle">Track your achievements and progress</p>
                    </div>
                </div>
            </div>
            
            <div class="coinbook-container">
                <!-- Progress Widget Container -->
                <div id="coinbookProgressWidget"></div>
            </div>
        </div>

        <!-- Achievement Detail Page Content -->
        <div class="page-content" id="achievementDetailPage" style="display: none;">
            <div class="page-header-minimal">
                <div class="page-header-content">
                    <div class="page-header-text">
                        <div class="page-header-breadcrumbs">
                            <a href="#home">Home</a>
                            <span>‚Ä∫</span>
                            <a href="#coinbook">Coin Book</a>
                            <span>‚Ä∫</span>
                            <span id="achievementDetailBreadcrumb">Achievement</span>
                        </div>
                        <h1 class="page-header-title">
                            <span class="page-header-icon" id="achievementDetailIcon">üèÜ</span>
                            <span id="achievementDetailTitle">Achievement Collection</span>
                        </h1>
                        <p class="page-header-subtitle" id="achievementDetailSubtitle">View your progress for this achievement</p>
                    </div>
                    <div class="page-header-action">
                        <a href="#rank" class="page-action-btn">
                            <span class="icon">‚≠ê</span>
                            <span>Rank Products</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Achievement Stats -->
            <div class="achievement-detail-stats">
                <div class="achievement-stat-card">
                    <div class="achievement-stat-icon">‚úÖ</div>
                    <div class="achievement-stat-content">
                        <div class="achievement-stat-value" id="achievementRankedCount">0</div>
                        <div class="achievement-stat-label">Ranked</div>
                    </div>
                </div>
                <div class="achievement-stat-card">
                    <div class="achievement-stat-icon">üîí</div>
                    <div class="achievement-stat-content">
                        <div class="achievement-stat-value" id="achievementUnrankedCount">0</div>
                        <div class="achievement-stat-label">Not Ranked</div>
                    </div>
                </div>
                <div class="achievement-stat-card">
                    <div class="achievement-stat-icon">üìä</div>
                    <div class="achievement-stat-content">
                        <div class="achievement-stat-value" id="achievementProgressPercentage">0%</div>
                        <div class="achievement-stat-label">Progress</div>
                    </div>
                </div>
            </div>

            <!-- Products Grid -->
            <div class="achievement-products-container">
                <div id="achievementProductsGrid" class="achievement-products-grid">
                    <div class="loading">Loading products...</div>
                </div>
            </div>
        </div>

        <!-- Tools Page Content (Employee Admin Only) -->
        <div class="page-content" id="toolsPage" style="display: none;">
            <div class="page-header-minimal">
                <div class="page-header-content">
                    <div class="page-header-text">
                        <div class="page-header-breadcrumbs">
                            <a href="#home">Home</a>
                            <span>‚Ä∫</span>
                            <span>Admin Tools</span>
                        </div>
                        <h1 class="page-header-title">
                            <span class="page-header-icon">üõ†Ô∏è</span>
                            <span>Admin Tools</span>
                        </h1>
                        <p class="page-header-subtitle">Management tools for jerky.com employees</p>
                    </div>
                    <div class="page-header-action">
                        <button class="page-action-btn" onclick="location.reload()">
                            <span class="icon">üîÑ</span>
                            <span>Refresh Data</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="tools-page-container">

                <!-- Tools Navigation -->
                <div class="tools-nav">
                    <button class="tools-nav-btn active" data-tool="achievements">Manage Coins</button>
                    <button class="tools-nav-btn" data-tool="live-users">Live Users</button>
                    <button class="tools-nav-btn" data-tool="products">Manage Products</button>
                    <button class="tools-nav-btn" data-tool="data" id="manageDataTabBtn" style="display: none;">üîê Manage Data</button>
                </div>

                <!-- Manage Coins Tool -->
                <div class="tool-section active" id="achievementsTool">
                    <div class="tool-header">
                        <h3>üèÜ Coin Book Admin Dashboard</h3>
                        <div class="tool-header-actions">
                            <button class="btn-primary" id="createAchievementBtn">+ Create Coin</button>
                        </div>
                    </div>
                    
                    <!-- Achievement Type Filters -->
                    <div class="achievement-type-nav">
                        <button class="achievement-type-btn active" data-type="all">All Coins</button>
                        <button class="achievement-type-btn" data-type="engagement">üìö Engagement Coins</button>
                        <button class="achievement-type-btn" data-type="static">üèõÔ∏è Static Collection Coins</button>
                        <button class="achievement-type-btn" data-type="flavor_coin">ü™ô Flavor Coins</button>
                        <button class="achievement-type-btn" data-type="legacy">‚öôÔ∏è Legacy</button>
                    </div>
                    
                    <!-- Hidden Status Filters -->
                    <div class="achievement-type-nav" style="margin-top: 10px;">
                        <button class="achievement-hidden-btn active" data-hidden="all">All Visibility</button>
                        <button class="achievement-hidden-btn" data-hidden="visible">üëÅÔ∏è Visible Only</button>
                        <button class="achievement-hidden-btn" data-hidden="hidden">üîí Hidden Only</button>
                    </div>
                    
                    <div class="achievements-table-container">
                        <table class="achievements-table">
                            <thead>
                                <tr>
                                    <th>Icon</th>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Category</th>
                                    <th>Description</th>
                                    <th>Points</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="achievementsTableBody">
                                <tr>
                                    <td colspan="8" style="text-align: center; padding: 40px; color: #999;">
                                        Loading achievements...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Live Users Tool -->
                <div class="tool-section" id="liveUsersTool" style="display: none;">
                    <div class="live-users-header">
                        <h3>üë• Active Users</h3>
                        <div class="live-users-stats">
                            <span class="live-count-badge" id="liveUserCount">0 online</span>
                            <span class="live-indicator">üü¢ Live</span>
                        </div>
                    </div>
                    <div class="live-users-table-container">
                        <table class="live-users-table">
                            <thead>
                                <tr>
                                    <th>User</th>
                                    <th>Email</th>
                                    <th>Current Page</th>
                                    <th>Connected</th>
                                    <th>Last Activity</th>
                                    <th>Connection ID</th>
                                </tr>
                            </thead>
                            <tbody id="liveUsersTableBody">
                                <tr>
                                    <td colspan="6" style="text-align: center; padding: 40px; color: #999;">
                                        No active users at the moment
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Products Management Tool -->
                <div class="tool-section" id="productsTool" style="display: none;">
                    <div class="products-header">
                        <h3>ü•© Product Management</h3>
                        <div class="products-count-badge" id="productsCount">0 products</div>
                    </div>
                    
                    <!-- Filters and Search -->
                    <div class="products-filters collapsed" id="productsFilters">
                        <button class="products-filter-toggle-button" id="productsFilterToggle" aria-expanded="false" aria-label="Show filters">
                            <div class="products-filter-title-section">
                                <span class="products-filter-title">üîç Filters</span>
                                <span class="products-filter-count-badge" id="productsActiveFilterCount" style="display: none;">0 active</span>
                            </div>
                            <span class="products-filter-chevron">‚ñº</span>
                        </button>
                        
                        <div class="products-filter-content" id="productsFilterContent" aria-hidden="true" hidden>
                            <div class="products-search-box">
                                <input type="text" id="productsSearch" placeholder="Search by any attribute..." />
                            </div>
                            <div class="products-filter-dropdowns">
                                <select id="vendorFilter" class="product-filter-select">
                                    <option value="">All Vendors</option>
                                </select>
                                <select id="animalTypeFilter" class="product-filter-select">
                                    <option value="">All Animal Types</option>
                                </select>
                                <select id="animalDisplayFilter" class="product-filter-select">
                                    <option value="">All Animal Displays</option>
                                </select>
                                <select id="primaryFlavorFilter" class="product-filter-select">
                                    <option value="">All Flavors</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="products-table-container">
                        <table class="products-table">
                            <thead>
                                <tr>
                                    <th>Image</th>
                                    <th>Title</th>
                                    <th>Vendor</th>
                                    <th>Animal Type</th>
                                    <th>Animal Display</th>
                                    <th>Primary Flavor</th>
                                    <th>Price</th>
                                    <th>Rankings</th>
                                    <th>Avg Rank</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="productsTableBody">
                                <!-- Table rows will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Manage Data Tool (Super Admin Only - ray@jerky.com) -->
                <div class="tool-section" id="dataTool" style="display: none;">
                    <div class="tool-header">
                        <h3>üîê Data Management (Super Admin Only)</h3>
                        <div class="tool-header-subtitle">
                            <span style="color: #c4a962;">‚ö†Ô∏è Destructive operations - Use with caution</span>
                        </div>
                    </div>
                    
                    <div class="data-management-container">
                        <div class="data-action-section">
                            <div class="data-action-card">
                                <div class="data-action-header">
                                    <span class="data-action-icon">üóëÔ∏è</span>
                                    <div>
                                        <h4>Clear All Cache</h4>
                                        <p>Clears all cached data including achievements, leaderboards, product metadata, and home stats. Cache will rebuild automatically on next request.</p>
                                    </div>
                                </div>
                                <button class="btn-warning" id="clearAllCacheBtn">üóëÔ∏è Clear All Cache</button>
                            </div>
                            
                            <div class="data-action-card danger">
                                <div class="data-action-header">
                                    <span class="data-action-icon">‚ö†Ô∏è</span>
                                    <div>
                                        <h4>Clear All Achievement Data</h4>
                                        <p><strong>DANGER:</strong> This permanently deletes all user achievement progress, points, and tiers. This action cannot be undone!</p>
                                    </div>
                                </div>
                                <button class="btn-danger" id="clearAllAchievementsBtn">‚ö†Ô∏è Clear All Data</button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <!-- Clear All Confirmation Modal -->
    <div id="clearModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Clear All Rankings?</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to clear all your rankings? This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button id="cancelClearBtn" class="modal-btn cancel-btn">Cancel</button>
                <button id="confirmClearBtn" class="modal-btn confirm-btn">Clear All</button>
            </div>
        </div>
    </div>

    <!-- Ranking Action Modal -->
    <div id="rankModal" class="modal">
        <div class="modal-content rank-modal-content">
            <div class="modal-header">
                <h3 id="rankModalTitle">Rank Product</h3>
                <button id="closeRankModal" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body rank-modal-body">
                <div id="rankingPositions" class="ranking-positions">
                    <!-- Position buttons will be dynamically generated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmationModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3 id="modalTitle">Confirm Action</h3>
            <p id="modalMessage">Are you sure you want to proceed?</p>
            <div id="modalInputContainer" style="display: none; margin-top: 20px; margin-bottom: 30px;">
                <p id="modalInputLabel" style="margin-bottom: 10px; font-size: 14px; color: #666;">Type <strong id="modalRequiredText" style="color: #c4a962;"></strong> to confirm:</p>
                <input type="text" id="modalConfirmInput" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 4px; font-size: 14px; font-family: monospace; box-sizing: border-box;" placeholder="" />
            </div>
            <div class="modal-actions" style="margin-top: 0;">
                <button class="btn-secondary" id="modalCancelBtn">Cancel</button>
                <button class="btn-danger" id="modalConfirmBtn">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Achievement Form Modal -->
    <div id="achievementFormModal" class="modal-overlay" style="display: none;">
        <div class="modal-content achievement-form-modal">
            <div class="modal-header">
                <h3 id="achievementFormTitle">Create Coin</h3>
                <button class="modal-close-btn" id="closeAchievementFormBtn">&times;</button>
            </div>
            <form id="achievementForm" class="achievement-form">
                <input type="hidden" id="achievementId" name="id">
                
                <div class="form-section">
                    <h4>Basic Information</h4>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="achievementCode">Code (unique identifier)*</label>
                            <input type="text" id="achievementCode" name="code" required placeholder="e.g., beef_master_bronze">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Icon*</label>
                        <div class="icon-type-selector">
                            <label class="icon-type-radio">
                                <input type="radio" name="iconType" value="emoji" checked id="iconTypeEmoji">
                                <span>Emoji</span>
                            </label>
                            <label class="icon-type-radio">
                                <input type="radio" name="iconType" value="image" id="iconTypeImage">
                                <span>Custom Image</span>
                            </label>
                        </div>
                        
                        <div id="emojiIconSection" class="icon-input-section">
                            <input type="text" id="achievementIcon" name="icon" required placeholder="e.g., ü•á" maxlength="4">
                        </div>
                        
                        <div id="imageIconSection" class="icon-input-section" style="display: none;">
                            <input type="file" id="customIconUpload" accept="image/png,image/jpeg,image/webp" style="display: none;">
                            <button type="button" class="upload-icon-btn" id="uploadIconBtn">
                                üìÅ Choose Image
                            </button>
                            <input type="hidden" id="customIconPath" name="customIconPath">
                            <div id="iconPreview" class="icon-preview" style="display: none;">
                                <img id="iconPreviewImg" alt="Icon preview">
                                <button type="button" class="remove-icon-btn" id="removeIconBtn">‚úï</button>
                            </div>
                            <div class="icon-upload-help">
                                <strong>Requirements:</strong> PNG, JPG, or WebP ‚Ä¢ 128x128 pixels (square) ‚Ä¢ Max 500KB<br>
                                <em>Transparent PNG recommended for best results</em>
                            </div>
                            <div id="iconUploadProgress" class="icon-upload-progress" style="display: none;">
                                <div class="progress-bar-container">
                                    <div class="progress-bar-fill" id="iconUploadProgressBar"></div>
                                </div>
                                <div class="progress-text" id="iconUploadProgressText">Uploading... 0%</div>
                            </div>
                            <div id="iconUploadStatus" class="icon-upload-status"></div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="achievementName">Name*</label>
                        <input type="text" id="achievementName" name="name" required placeholder="e.g., Beef Master">
                    </div>
                    
                    <div class="form-group">
                        <label for="achievementDescription">Description*</label>
                        <textarea id="achievementDescription" name="description" required placeholder="e.g., Complete 40% of all beef products" rows="3"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="achievementPoints">Points</label>
                            <input type="number" id="achievementPoints" name="points" value="0" min="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="achievementIsActive">Active Status</label>
                            <select id="achievementIsActive" name="isActive">
                                <option value="1" selected>Active</option>
                                <option value="0">Inactive</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="form-section">
                    <h4>Collection Type</h4>
                    
                    <div class="form-group">
                        <label for="achievementCollectionType">Coin Type*</label>
                        <select id="achievementCollectionType" name="collectionType" required>
                            <option value="">Select Type</option>
                            <option value="engagement_collection">Engagement Coin</option>
                            <option value="static_collection">Static Collection Coin</option>
                            <option value="flavor_coin">Flavor Coin</option>
                            <option value="custom_product_list" style="display:none;">Pre-Defined List of Products (Legacy)</option>
                            <option value="legacy">Legacy Achievement</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="proteinCategoryGroup" style="display: none;">
                        <label>Animal Categories (select one or more)</label>
                        <div id="animalCategoriesContainer" class="protein-category-checkboxes">
                            <div style="text-align: center; padding: 20px; color: #999;">
                                Loading animals...
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group" id="legacyFieldsGroup" style="display: none;">
                        <label for="achievementTier">Legacy Tier</label>
                        <select id="achievementTier" name="tier">
                            <option value="">None</option>
                            <option value="bronze">Bronze</option>
                            <option value="silver">Silver</option>
                            <option value="gold">Gold</option>
                            <option value="platinum">Platinum</option>
                            <option value="diamond">Diamond</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="legacyCategoryGroup" style="display: none;">
                        <label for="achievementCategory">Legacy Category</label>
                        <select id="achievementCategory" name="category">
                            <option value="">None</option>
                            <option value="ranking">Ranking</option>
                            <option value="social">Social</option>
                            <option value="discovery">Discovery</option>
                            <option value="streak">Streak</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="achievementIsHidden" name="isHidden" value="1">
                            Hidden Achievement (unlock criteria not shown)
                        </label>
                    </div>
                    
                    <div class="form-group">
                        <label for="achievementPrerequisite">Prerequisite Achievement (Optional)</label>
                        <select id="achievementPrerequisite" name="prerequisiteAchievementId">
                            <option value="">None - No prerequisite required</option>
                        </select>
                        <small>Users must earn this achievement first before this one can be unlocked</small>
                    </div>
                </div>
                
                <div class="form-section" id="unlockRequirementsSection">
                    <h4>Unlock Requirements*</h4>
                    <p class="help-text">Define how users earn this achievement. For Dynamic Collections, requirements are automatic based on protein categories + tier thresholds.</p>
                    <div class="form-group">
                        <label for="requirementType">How do users earn this achievement?</label>
                        <select id="requirementType" name="requirementType">
                            <option value="">-- Select Requirement Type --</option>
                            <option value="rank_count">Rank a certain number of products</option>
                            <option value="complete_animal_category">Complete all products in one or more animal categories</option>
                            <option value="complete_flavor_set">Rank specific flavors</option>
                            <option value="search_count">Perform searches</option>
                            <option value="daily_login_streak">Login daily for consecutive days</option>
                            <option value="daily_rank_streak">Rank products daily for consecutive days</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="rankCountGroup" style="display: none;">
                        <label for="rankCountValue">How many products must be ranked?</label>
                        <input type="number" id="rankCountValue" name="rankCountValue" min="1" placeholder="e.g., 10">
                    </div>
                    
                    <div class="form-group" id="animalCategoryCountGroup" style="display: none;">
                        <label for="animalCategoryCount">How many animal categories must be completed?</label>
                        <input type="number" id="animalCategoryCount" name="animalCategoryCount" min="1" max="6" placeholder="e.g., 1">
                        <small>User must fully complete this many animal categories (e.g., all beef products)</small>
                    </div>
                    
                    <div class="form-group" id="flavorSetGroup" style="display: none;">
                        <label>Which flavors are required?</label>
                        <div class="flavor-checkboxes">
                            <label class="checkbox-label"><input type="checkbox" name="requiredFlavors" value="sweet"> üçØ Sweet</label>
                            <label class="checkbox-label"><input type="checkbox" name="requiredFlavors" value="spicy"> üå∂Ô∏è Spicy</label>
                            <label class="checkbox-label"><input type="checkbox" name="requiredFlavors" value="savory"> üßÇ Savory</label>
                            <label class="checkbox-label"><input type="checkbox" name="requiredFlavors" value="smoky"> üí® Smoky</label>
                            <label class="checkbox-label"><input type="checkbox" name="requiredFlavors" value="tangy"> üçã Tangy</label>
                            <label class="checkbox-label"><input type="checkbox" name="requiredFlavors" value="bbq"> üçñ BBQ</label>
                            <label class="checkbox-label"><input type="checkbox" name="requiredFlavors" value="teriyaki"> ü•¢ Teriyaki</label>
                            <label class="checkbox-label"><input type="checkbox" name="requiredFlavors" value="peppered"> ‚ö´ Peppered</label>
                        </div>
                    </div>
                    
                    <div class="form-group" id="searchCountGroup" style="display: none;">
                        <label for="searchCountValue">How many searches must be performed?</label>
                        <input type="number" id="searchCountValue" name="searchCountValue" min="1" placeholder="e.g., 50">
                    </div>
                    
                    <div class="form-group" id="streakDaysGroup" style="display: none;">
                        <label for="streakDaysValue">How many consecutive days?</label>
                        <input type="number" id="streakDaysValue" name="streakDaysValue" min="1" placeholder="e.g., 7">
                    </div>
                </div>
                
                <div class="form-section" id="productSelectorSection" style="display: none;">
                    <h4>Select Products for Collection</h4>
                    <p class="help-text">Search and select products to include in this custom collection. Users will earn tiers based on how many of these products they rank.</p>
                    
                    <div class="product-selector-split-view">
                        <!-- Left: Selected Products -->
                        <div class="product-selector-left">
                            <div class="selected-products-header">
                                <h5>Selected Products (<span id="selectedProductCount">0</span>)</h5>
                            </div>
                            <div id="selectedProductsList" class="selected-products-list">
                                <div class="empty-state">
                                    <p>No products selected yet</p>
                                    <small>Search and click products on the right to add them</small>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Right: Product Browser -->
                        <div class="product-selector-right">
                            <div class="product-search-header">
                                <h5>Available Products</h5>
                                <div class="product-count-info" id="availableProductsCount">Loading...</div>
                                <input type="text" id="productSearchInput" placeholder="Search products..." class="product-search-input" style="margin-top: 12px;">
                            </div>
                            <div id="availableProductsList" class="available-products-list">
                                <div class="loading-state" style="text-align: center; padding: 40px; color: #999;">
                                    Loading products...
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Hidden input to store selected product IDs -->
                    <input type="hidden" id="selectedProductIds" name="selectedProductIds" value="">
                </div>
                
                <div class="form-section" id="tierThresholdsSection" style="display: none;">
                    <h4>Tier Configuration</h4>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="achievementHasTiers" name="hasTiers" value="1">
                            Enable Tiers (bronze, silver, gold, etc.)
                        </label>
                        <p class="help-text" style="margin-top: 8px;">Uncheck for single-completion achievements (like Flavor Coins) where users either earn it or don't - no progression tiers.</p>
                    </div>
                    <div id="tierThresholdsInputs" style="display: none;">
                        <p class="help-text">Set completion percentages for each tier. Users progress through tiers as they complete more items.</p>
                        <div class="tier-inputs-grid">
                        <div class="tier-input-group">
                            <label for="tierBronze">ü•â Bronze</label>
                            <input type="number" id="tierBronze" name="tierBronze" min="1" max="100" value="40" placeholder="40">
                            <span class="tier-suffix">%</span>
                        </div>
                        <div class="tier-input-group">
                            <label for="tierSilver">ü•à Silver</label>
                            <input type="number" id="tierSilver" name="tierSilver" min="1" max="100" value="60" placeholder="60">
                            <span class="tier-suffix">%</span>
                        </div>
                        <div class="tier-input-group">
                            <label for="tierGold">ü•á Gold</label>
                            <input type="number" id="tierGold" name="tierGold" min="1" max="100" value="75" placeholder="75">
                            <span class="tier-suffix">%</span>
                        </div>
                        <div class="tier-input-group">
                            <label for="tierPlatinum">üíé Platinum</label>
                            <input type="number" id="tierPlatinum" name="tierPlatinum" min="1" max="100" value="90" placeholder="90">
                            <span class="tier-suffix">%</span>
                        </div>
                        <div class="tier-input-group">
                            <label for="tierDiamond">üí† Diamond</label>
                            <input type="number" id="tierDiamond" name="tierDiamond" min="1" max="100" value="100" placeholder="100">
                            <span class="tier-suffix">%</span>
                        </div>
                    </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="cancelAchievementFormBtn">Cancel</button>
                    <button type="submit" class="btn-primary" id="saveAchievementBtn">
                        <span id="saveAchievementBtnText">Save Coin</span>
                        <span id="saveAchievementBtnSpinner" style="display: none;">
                            <span class="spinner"></span> Saving...
                        </span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Product Edit Modal -->
    <div id="productEditModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ü•© Edit Product Metadata</h3>
                <button class="modal-close-btn" id="closeProductEditBtn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editProductId">
                <div class="form-group">
                    <label>Product</label>
                    <div id="editProductName" style="font-weight: 500; margin-bottom: 15px;"></div>
                </div>
                <div class="form-group">
                    <label for="editAnimalSelect">Animal Category*</label>
                    <select id="editAnimalSelect" class="form-control" required>
                        <option value="">Select an animal...</option>
                    </select>
                    <small style="display: block; margin-top: 5px; color: #999;">
                        Selecting an animal will automatically set the animal type, display name, and icon.
                    </small>
                </div>
                <div class="form-group">
                    <label>Preview</label>
                    <div id="animalPreview" style="padding: 10px; border: 1px solid #ddd; border-radius: 4px; background: #f9f9f9; display: none;">
                        <div><strong>Icon:</strong> <span id="previewIcon"></span></div>
                        <div><strong>Display:</strong> <span id="previewDisplay"></span></div>
                        <div><strong>Type:</strong> <span id="previewType"></span></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="display: flex; gap: 10px; justify-content: flex-end;">
                <button class="btn-secondary" id="cancelProductEditBtn">Cancel</button>
                <button class="btn-primary" id="saveProductEditBtn">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Socket.IO Client -->
    <script src="/socket.io/socket.io.js"></script>
    
    <!-- Core Architecture -->
    <script src="js/core/EventBus.js"></script>
    <script src="js/core/ServiceRegistry.js"></script>
    <script src="js/core/BaseService.js"></script>
    <script src="js/core/BaseController.js"></script>
    <script src="js/utils/DOMHelpers.js"></script>
    
    <!-- Services -->
    <script src="js/services/GamificationService.js?v=20251013b"></script>
    <script src="js/services/SocialProofService.js"></script>
    <script src="js/services/ActivityFeedService.js"></script>
    <script src="js/services/ProgressTrackingService.js"></script>
    <script src="js/services/LeaderboardService.js"></script>
    <script src="js/services/PageViewTracker.js"></script>
    
    <!-- UI Components -->
    <script src="js/components/NotificationWidget.js"></script>
    <script src="js/components/ProgressWidget.js?v=20251012d"></script>
    <script src="js/components/LeaderboardWidget.js"></script>
    <script src="js/components/FullLeaderboardWidget.js"></script>
    
    <!-- Application Initialization -->
    <script src="js/app-init.js"></script>
    
    <!-- Main Application (Legacy) -->
    <script src="app.js?v=20251012b"></script>
    
    <!-- Page Scripts -->
    <script src="js/pages/coinbook.js"></script>
    <script src="js/pages/achievementDetail.js"></script>
    <script src="js/pages/toolsAdmin.js"></script>
    <script src="js/pages/tools.js"></script>
    
    <!-- Page Integrations -->
    <script src="js/page-integrations.js"></script>
    
    <!-- Home Dashboard -->
    <script src="js/home-dashboard.js"></script>
    
    <!-- Hero Dashboard -->
    <script src="js/hero-dashboard.js"></script>
    
    <!-- Footer Navigation -->
    <script src="js/footer.js"></script>

    <!-- Site Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Navigation</h4>
                <ul class="footer-links">
                    <li><a href="#home">Home</a></li>
                    <li><a href="#products">Products</a></li>
                    <li><a href="#community">Community</a></li>
                    <li><a href="#rank">Rank Jerky</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4>Account</h4>
                <ul class="footer-links">
                    <li><a href="#profile" id="footerProfileLink">My Profile</a></li>
                    <li><a href="#login" id="footerLoginLink">Log In</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4>Jerky.com</h4>
                <ul class="footer-links">
                    <li><a href="https://jerky.com" target="_blank" rel="noopener">Shop Jerky</a></li>
                    <li><a href="https://jerky.com/pages/quiz" target="_blank" rel="noopener">Take the Quiz</a></li>
                    <li><a href="https://jerky.com/pages/about" target="_blank" rel="noopener">About Us</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4>Legal</h4>
                <ul class="footer-links">
                    <li><a href="https://jerky.com/policies/privacy-policy" target="_blank" rel="noopener">Privacy Policy</a></li>
                    <li><a href="https://jerky.com/policies/terms-of-service" target="_blank" rel="noopener">Terms of Service</a></li>
                </ul>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2025 Jerky.com. All rights reserved. | Community Ranking Platform</p>
        </div>
    </footer>
</body>
</html>